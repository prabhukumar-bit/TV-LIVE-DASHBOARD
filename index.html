<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Google Sheet Live Dashboard</title>

<style>
html, body {
  height: 100%;
  margin: 0;
  font-family: "Segoe UI", Arial, sans-serif;
  overflow: hidden;
  background: radial-gradient(circle at top, #2c3e50, #0f2027);
  position: relative;
  display: flex;
  flex-direction: column;
}

/* ===== PARTICLES ===== */
#particles {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  overflow: hidden;
  z-index: 0;
}

.particle {
  position: absolute;
  width: 25px;      /* aur bada size */
  height: 25px;     /* aur bada size */
  background: rgba(255, 255, 255, 0.6);
  border-radius: 50%;
  animation: floatParticle linear infinite;
}

@keyframes floatParticle {
  0% {
    transform: translateY(0) translateX(0);
    opacity: 0.3;
  }
  50% {
    opacity: 0.7;
  }
  100% {
    transform: translateY(-120vh) translateX(50vw);
    opacity: 0.1;
  }
}

/* ===== CONTROLS ===== */
#controls {
  position: relative;
  z-index: 2;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 12px;
  background: rgba(255,255,255,0.08);
  backdrop-filter: blur(8px);
  box-shadow: 0 2px 10px rgba(0,0,0,0.5);
}

#controls button {
  margin: 0 14px;
  padding: 12px 0;
  width: 130px;
  font-size: 20px;
  font-weight: bold;
  border-radius: 14px;
  border: none;
  cursor: pointer;
  background: linear-gradient(to bottom, #4b6cb7, #182848);
  color: white;
  transition: transform 0.2s, box-shadow 0.2s;
  text-align: center;
}

#controls button:hover {
  transform: scale(1.1);
  box-shadow: 0 6px 18px rgba(0,0,0,0.6);
}

/* ===== REPORT CONTAINER ===== */
#report-container {
  position: relative;
  z-index: 2;
  flex: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 20px;
  box-sizing: border-box;
  transition: opacity 0.6s ease, transform 0.6s ease;
}

#report-container.fade {
  opacity: 0;
  transform: scale(0.95);
}

/* ===== TABLE ===== */
table {
  width: 100%;
  max-width: 95%;
  border-collapse: separate;
  border-spacing: 0;
  border-radius: 18px;
  overflow: hidden;
  box-shadow:
    0 18px 45px rgba(0,0,0,0.6),
    inset 0 0 0 3px #111;
  background: #ffffff;
}

/* ROW */
table tr {
  transition: background 0.3s ease;
}

/* HEADER */
th {
  background: linear-gradient(to bottom, #4b6cb7, #182848);
  color: #fff;
  font-weight: 900;
  padding: 14px;
  text-align: center;
  text-shadow: 0 1px 3px rgba(0,0,0,0.7);
}

/* CELLS */
td {
  border: 1px solid #333;
  text-align: center;
  vertical-align: middle;
  padding: 14px;
  font-weight: 600;
  position: relative;
  transition: transform 0.2s, box-shadow 0.2s;
}

td::after {
  content: "";
  position: absolute;
  inset: 0;
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.25);
  pointer-events: none;
}

td:hover {
  transform: scale(1.04);
  box-shadow: 0 0 18px rgba(0,0,0,0.35);
}

td.bold {
  box-shadow: inset 0 0 12px rgba(255, 215, 0, 0.7);
}
</style>
</head>

<body>

<div id="particles"></div>

<div id="report-container">Loading...</div>

<div id="controls">
  <button id="prev-slide">◀ Previous</button>
  <button id="play-pause">Pause</button>
  <button id="next-slide">Next ▶</button>
</div>

<script>
/* ===== PARTICLES GENERATION ===== */
const particleCount = 80;
const particlesContainer = document.getElementById("particles");

for(let i=0;i<particleCount;i++){
  const p = document.createElement("div");
  p.className = "particle";
  p.style.left = Math.random()*100 + "vw";
  p.style.top = Math.random()*100 + "vh";
  p.style.width = 30 + Math.random()*25 + "px";   // 20–35px
  p.style.height = p.style.width;
  p.style.animationDuration = 10 + Math.random()*20 + "s";
  p.style.opacity = 0.7 + Math.random()*0.3;     // 0.7–1
  particlesContainer.appendChild(p);
}

/* ===== GOOGLE SHEET DASHBOARD LOGIC ===== */
const SHEET_ID = "1QS69ZNqIehztWHNQR1NDnCzMXOFEPTcgSwQARmRzZig";
const API_KEY = "AIzaSyBw2ua8ipnTs6bGZ2o2CwMbv6ngP5Pl12w";

const RANGES = [
  "JFM!J22:K25",
  "JFM!J16:K20",
  "JFM!J2:M6",
  "JFM!J8:M13",
  "JFM!A51:C59",
  "JFM!A60:C68",
  "JFM!A69:C74",
  "JFM!A111:C115",
  "JFM!A104:D108",
  "JFM!A117:D121",
  "JFM!G27:K34",
  "JFM!G35:K42",
  "JFM!G43:K50",
];

let currentSlide = 0;
let slideInterval = null;
let isPlaying = true;

function parseRange(range) {
  const [, cells] = range.split("!");
  const [start] = cells.split(":");
  const colLetters = start.match(/[A-Z]+/)[0];
  const rowNumber = parseInt(start.match(/\d+/)[0], 10);
  const startCol = colLetters
    .split("")
    .reduce((sum, c) => sum * 26 + (c.charCodeAt(0) - 64), 0) - 1;
  return { startRow: rowNumber - 1, startCol };
}

function buildURL(range) {
  return `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}?ranges=${encodeURIComponent(range)}&includeGridData=true&fields=sheets.data.rowData.values(formattedValue,userEnteredFormat),sheets.merges&key=${API_KEY}`;
}

async function fetchSheetData(range) {
  const res = await fetch(buildURL(range));
  const data = await res.json();
  return {
    rows: data.sheets?.[0]?.data?.[0]?.rowData || [],
    merges: data.sheets?.[0]?.merges || []
  };
}

function applyStyles(td, format) {
  if (!format) return;

  if (format.backgroundColor || format.backgroundColorStyle?.rgbColor) {
    const c = format.backgroundColor || format.backgroundColorStyle?.rgbColor;
    const r = Math.round((c.red || 0) * 255);
    const g = Math.round((c.green || 0) * 255);
    const b = Math.round((c.blue || 0) * 255);
    const a = c.alpha ?? 1;
    td.style.backgroundColor = `rgba(${r},${g},${b},${a})`;
  }

  if (format.textFormat?.bold) {
    td.style.fontWeight = "900";
    td.classList.add("bold");
  }
}

function getMergeInfo(merges, row, col, offset) {
  const absRow = row + offset.startRow;
  const absCol = col + offset.startCol;

  for (const m of merges) {
    if (absRow === m.startRowIndex && absCol === m.startColumnIndex) {
      return {
        rowspan: m.endRowIndex - m.startRowIndex,
        colspan: m.endColumnIndex - m.startColumnIndex
      };
    }
    if (
      absRow >= m.startRowIndex &&
      absRow < m.endRowIndex &&
      absCol >= m.startColumnIndex &&
      absCol < m.endColumnIndex
    ) return "SKIP";
  }
  return null;
}

function adjustFontSize() {
  const container = document.getElementById("report-container");
  const table = container.querySelector("table");
  if (!table) return;
  table.style.fontSize =
    Math.floor(container.clientHeight / table.rows.length * 0.45) + "px";
}

function renderTable(rows, merges, offset) {
  const container = document.getElementById("report-container");
  container.innerHTML = "";
  const table = document.createElement("table");

  rows.forEach((row, r) => {
    const tr = document.createElement("tr");
    (row.values || []).forEach((cell, c) => {
      const merge = getMergeInfo(merges, r, c, offset);
      if (merge === "SKIP") return;

      const td = document.createElement(r === 0 ? "th" : "td");
      td.innerText = cell?.formattedValue || "";

      if (merge) {
        td.rowSpan = merge.rowspan;
        td.colSpan = merge.colspan;
      }

      applyStyles(td, cell?.userEnteredFormat);
      tr.appendChild(td);
    });
    table.appendChild(tr);
  });

  container.appendChild(table);
  adjustFontSize();
}

async function loadSlide(i = null) {
  const container = document.getElementById("report-container");
  container.classList.add("fade");

  setTimeout(async () => {
    if (i !== null) currentSlide = i;
    const range = RANGES[currentSlide];
    const offset = parseRange(range);
    const { rows, merges } = await fetchSheetData(range);
    renderTable(rows, merges, offset);
    container.classList.remove("fade");
  }, 300);
}

function startSlideShow() {
  slideInterval = setInterval(() => {
    currentSlide = (currentSlide + 1) % RANGES.length;
    loadSlide();
  }, 5000);
  document.getElementById("play-pause").innerText = "Pause";
  isPlaying = true;
}

function stopSlideShow() {
  clearInterval(slideInterval);
  document.getElementById("play-pause").innerText = "Play";
  isPlaying = false;
}

document.getElementById("play-pause").onclick = () =>
  isPlaying ? stopSlideShow() : startSlideShow();

document.getElementById("prev-slide").onclick = () => {
  stopSlideShow();
  currentSlide = (currentSlide - 1 + RANGES.length) % RANGES.length;
  loadSlide();
};

document.getElementById("next-slide").onclick = () => {
  stopSlideShow();
  currentSlide = (currentSlide + 1) % RANGES.length;
  loadSlide();
};

loadSlide();
startSlideShow();
</script>

</body>
</html>


